
@{
    ViewBag.Title = "Index";
    var countrieName = ViewBag.countrieName;
}

<link href="~/Content/Style/style.css" rel="stylesheet" />
<link href="~/Content/Style/main.css" rel="stylesheet" />
<link href="~/Content/Style/display.css" rel="stylesheet" />
<link href="~/Content/Style/DeviceInput.css" rel="stylesheet" />
<link href="~/Content/Style/cusel.css" rel="stylesheet" />
@*<link href="~/Content/Style/CheckedStyle.css" rel="stylesheet" />*@
<link href="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.5.7/css/jsplumbtoolkit-defaults.css" rel="stylesheet" />

<div id="leftDiv">
    <!-- Information about device -->
    <div id="deviceInfo">
        <ul id="menu">
            <!-- Device name -->
            <li>
                @*<span id="DevName">Device</span>*@
                <span id="DevName">Device </span>
                <span id="AddGroup" data-toggle="modal" data-target="#groupModal" style="width: 60px;margin-left:198px; margin-top:-20px;">Add Group</span>
                
                    <ul id="deviceName" class="devInfo"></ul>
                
            </li>
            <!-- List of available interfaces -->
            <li>
                <span id="countrie">Countries</span>
                <ul id="countries" class="devInfo">
                    <li class="countries">Countrie
                        
                    </li>
                </ul>
            </li>
            <!-- List of available displays -->
            <li>
                <span id="Disp">Display</span>
                <ul id="display" class="devInfo">
                    @*<li class="display">
                        </li>*@
                </ul>
            </li>
            <!-- List of available audio output devices -->
            <li>
                <span id="Output">Output</span>
                <ul id="output" class="devInfo">
                    @*<li>
                        </li>*@
                </ul>
            </li>
            <!-- List of streams -->
            <li>
                <span id="Stream">Streams</span>
                <ul id="streams" class="devInfo">
                    @*<li class="stream">

                        </li>*@

                </ul>
            </li>

            <div id="add_device_partial">
                @*<li>
                    <div class="widget-container widget_categories widget_categories_filter boxed">
                        <div class="inner">
                            <ul>
                                <li class="first gradient"><div class="input_wrap"><input class="deviceInput inputField gradient" name="device_name" id="device_name" placeholder="Device Name" value="" type="text" hidefocus="true" style="outline: none; color: white"></div></li>
                                <li class="current-menu-item gradient "><div class="input_wrap"><input class=" deviceInput inputField gradient" name="manufacture_name" id="manufacture_name" placeholder="ManuFacture" value="" type="text" hidefocus="true" style="outline: none; color: white"></div></li>
                                <li class="gradient"><div class="input_wrap"><input class="deviceInput inputField gradient" name="model_name" id="model_name" placeholder="Model" value="" type="text" hidefocus="true" style="outline: none; color: white"></div></li>
                                <li class="gradient"><div class="input_wrap"><input class="deviceInput inputField gradient" name="purpose_name" id="purpose_name" placeholder="Purpose" value="" type="text" hidefocus="true" style="outline: none; color: white"></div></li>
                                <li>
                                    <input name="mib_file" type="file" id="FileUpload" accept="file/*" style="display: none">
                                    <span class="btn btn-send" style="opacity: 0.8; height:25px; padding-right:0px">
                                        <label class="btn btn-send" for="FileUpload" style="height: 25px; width: 100%; line-height:25px;">Browser</label>
                                    </span>
                                    <span class="btn btn-send" style="opacity: 0.8; height:25px; padding-right:0px;margin-top:3px">
                                        <label class="btn btn-send" for="FileUpload" style="height: 25px; width: 100%; line-height:25px;">Add</label>
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>*@
            </div>
            @*<li>
                    <span id="Adapter">Adapters</span>
                    <ul id="adapters" class="devInfo">
                        <li class="adapter">
                            Adapter 0
                        </li>
                        <li class="adapter">
                            Adapter 1
                        </li>
                    </ul>
                </li>*@
        </ul>

        <!-- Buttons for saving, loading, clearing diagram and changing mode (This block is temporary) -->
        <!--<input type="button" id="save" name="save" value="save" />
        <input type="button" id="load" name="load" value="load" />-->
        @*<input type="button" id="clear" name="clear" value="Clear Diagram" class="btn" />
            <ul id="zoomButtons">
                <li><input type="button" id="zoomin" name="zoomin" value="Zoom in" class="btn" /></li>
                <li><input type="button" id="zoomout" name="zoomout" value="Zoom out" class="btn" /></li>
            </ul>*@
        <!--<button id="black">dark</button>
        <button id="white">light</button>-->
    </div>

    <div id="settingsDiv">

    </div>

    </div>
    <!-- Container for context menu. It appears only when user right clicks on one of the tables -->
    @*<div id="contextMenuDiv">
            <ul class="contextmenu" id="context">
                <li><a href="" class="hideTable">Close</a></li>
            </ul>
        </div>*@

    @*<table class="foo elementTable " name="title" id="">
    <tr class="tableHeader">
        <th class="thClass">
        <span class="header">stereo</span>
        <span class="settings">
        <img src="/Icons/pignon.png" style="width:17px; height:17px"alt="Settings" title="Settings" />
            </span></th></tr><tr><td class="add"><span class="addList">Add new link</span></td></tr></table>*@

@*</div>*@
<div id="mainDiv" >
   
</div>

<!-- Modal Group -->
<div>
    <div class="modal fade" id="groupModal" role="dialog">
        <div class="modal-dialog">
            <div class="widget-container widget_search styled boxed-velvet" style="width:250px;">
                <div class="inner gradient">
                    <form method="get" id="searchform2" action="#">
                        <div class="clearfix">
                            <span class="btn btn-small" style="opacity: 2001;"><input type="button" id="create_group" value="create" hidefocus="true" style="outline: none;" class="gradient" data-dismiss="modal"></span>
                            <div class="input_wrap"><input class="inputField gradient" name="group_name" id="group_name" placeholder="Group Name" value="" type="text" hidefocus="true" style="outline: none; color: white"></div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@*<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>*@

<script>
    var counter;
    $(document).ready(function () {
        counter = 0;
        $('.devInfo').hide();

        //

        //
        //var ListCount = 1;
        //$(document).on('click touch', '.addList', function () {
        //    var newtr = '<tr class="tableBody" id="' + ListCount + '_' + ListCount + '"><td class="tableConn">Link ' + (ListCount + 1) + '</td></tr>';
        //    ListCount += 1;
        //    $(newtr).insertBefore('.addList');

        //});
        //$('#DevName').click(function () {
        //    $("#deviceName").animate({ height: 'toggle', opacity: 'toggle' }, 300);
        //});

        //$("#mainDiv").sortable({
        //    revert: true
        //});
        
        //$('#checked_add').click(function () {
        //    if ($('#city_checked').is(':checked') == true) {
        //        $('#checked_add').removeClass("checked").addClass("");
        //        $("#city_checked").prop('checked', false);
        //        alert("true");
        //    }
        // else {
        //        $('#checked_add').removeClass("").addClass("checked");
        //        $("#city_checked").prop('checked', true);
        //        alert("false");
        //    }
        //});

        var handled = false; var width;                                          // countries search and full countries
        $('body').on('click touchend', '#typeSelect', function (e) {
             width = $(this).width();
            if (e.type == "touchend") {
                handled = true;
                $('#typeDropDownList').css({ 'width': width + 12 }).toggle();
                $('.typeSelect li').css('widht', '93%');
            }
            else
                if (e.type == "click" && !handled) {
                    $('#typeDropDownList').css({ 'width': width + 12 }).toggle();
                    $.post("/DeviceGroup/countrieSearch", { CountrieName: CountrieName, StateName: StateName, CityName: CityName }, function (Response) {
                        $('#countrie_partial').html("");
                        $('#countrie_partial').html(Response);
                    }, 'text');
                }
                else {
                    handled = false;
                }
        });

        $('body').on('click touchend', '#typeDropDownList li', function () {
            var value = $(this).text();
            CountrieName = value;
            StateName = null;
            $('.header' + $('#typeDropDownList').attr('value')).text(value);
            $('#typeSelect #countrie').text(value);
            $('#typeDropDownList').css({ 'width': width + 12 }).toggle();
            //$.post("/DeviceGroup/countrieSearch", { CountrieName: CountrieName, StateName: StateName, CityName: CityName }, function (Response) {
            //    $('#settingsDiv').html("");
            //    $('#settingsDiv').html(Response);
            //}, 'text');

        });

        var handledstate = false;                                           // states search and full states
        $('body').on('click touchend', '#typeSelectState', function (e) {
            var width = $(this).width();
            if (e.type == "touchend") {
                handledstate = true;
                $('#typeDropDownListState').css({ 'width': width + 12 }).toggle();
            }
            else
                if (e.type == "click" && !handledstate) {
                    $('#typeDropDownListState').css({ 'width': width + 12 }).toggle();
                    $.post("/DeviceGroup/stateSearch", { CountrieName: CountrieName, CityName: CityName }, function (Response) {
                        $('#state_partial').html("");
                        $('#state_partial').html(Response);
                    }, 'text');
                }
                else {
                    handledstate = false;
                }

        });

        $('body').on('click touchend', '#typeDropDownListState li', function () {
            var value = $(this).text();
            StateName = value;
            $('#typeSelectState #state').text(value);
            $('#typeDropDownListState').css({ 'width': width + 12 }).toggle();
            //$.post("/DeviceGroup/Countries", { CountrieName: CountrieName, StateName: StateName, CityName: CityName }, function (Response) {
            //    $('#settingsDiv').html("");
            //    $('#settingsDiv').html(Response);
            //}, 'text');
          
        });

        var handledcity = false;
        $('body').on('click touchend', '#typeSelectCity', function (e) {
            var width = $(this).width();
            if (e.type == "touchend") {
                handledcity = true;
                $('#typeDropDownListCity').css({ 'width': width + 12 }).toggle();
            }
            else
                if (e.type == "click" && !handledcity) {
                    $('#typeDropDownListCity').css({ 'width': width + 12 }).toggle();
                    $.post("/DeviceGroup/citySearch", { StateName: StateName, CityName: CityName }, function (Response) {
                        $('#city_partial').html("");
                        $('#city_partial').html(Response);
                    }, 'text');
                }
                else {
                    handledcity = false;
                }

        });

        //$('body').on('click touchend', '#typeDropDownListCity li', function () {
        //    var value = $(this).text();
        //    alert("city");
        //    $('#typeSelectCity .type').text(value);
        //    $('#typeDropDownListCity').toggle();
        //});

        //$(document).on('click touch', '.addList', function () {
        //    $('.addList').val("hey brat");
           
        //});

        //var handled = false;
        //$('body').on('click touchend', '#typeSelect', function (e) {
        //    var width = $(this).width();
        //    if (e.type == "touchend") {
        //        handled = true;
        //        $('#typeDropDownList').css({ 'width': width + 12 }).toggle();
        //    }
        //    else 
        //        if (e.type == "click" && !handled) {
        //            $('#typeDropDownList').css({ 'width': width + 12 }).toggle();
        //        }
        //        else {
        //            handled = false;
        //        }
            
        //});

        //var handledstate = false;
        //$('body').on('click touchend', '#typeSelectState', function (e) {
        //    var width = $(this).width();
        //    if (e.type == "touchend") {
        //        handledstate = true;
        //        $('#typeDropDownListState').css({ 'width': width + 12 }).toggle();
        //    }
        //    else
        //        if (e.type == "click" && !handled) {
        //            $('#typeDropDownListState').css({ 'width': width + 12 }).toggle();
        //        }
        //        else {
        //            handledstate = false;
        //        }

        //});

        //$('body').on('click touchend', '#typeDropDownList li', function () {
        //    var value = $(this).text();
        //    $('#typeSelect .type').text(value);
        //    $('#typeDropDownList').toggle();
        //    //showTable();
        //});

        //$('body').on('click touchend', '#typeDropDownListState li', function () {
        //    var value = $(this).text();
        //    $('#typeSelectState .type').text(value);
        //    $('#typeDropDownListState').toggle();
        //    //showTable();
        //});

        //$('.last').click(function () {
        //    $('.cuselText').text($('.last').text());

        //});
        

        //$('.select_styled').click(function () {
        //    if ($('.cusel-scroll-wrap').css("display") == "block") {
        //        $('.cusel-scroll-wrap').css("display", "none");
        //    }
        //    else {
        //        $('.cusel-scroll-wrap').css("display", "block");
        //    }
        //});

        //$('#cuselFrame-contact_subject').click(function () {
        //    alert("no");
           
        //});

        $('#countrie').click(function () {
            $("#countries").animate({ height: 'toggle', opacity: 'toggle' }, 300);
        });

        $('#deviceName li').draggable({
            helper: 'clone',
            revert: 'invalid'
        });


        $('#countries li').draggable({
            helper: 'clone',
            revert: 'invalid'
        });



        function foo() {
            $('.foo').each(function () {
                //Making dropped elements draggable again
                $(this).draggable({
                    //containment: $(this).parent(),
                    stack: '.foo',
                    grid: [10, 10],
                    drop: function (event, ui) {
                        var pos = ui.draggable.offset(), dPos = $(this).offset();
                    },
                    drag: function () {
                        //jsPlumb.addToDragSelection($('.foo'));
                        var draggedItemId = $(this).attr('id');
                        $('.contextmenu').hide();
                        $(this).css({ 'z-index': '11' });
                        $(".class" + draggedItemId).css({ 'z-index': '15' });
                    },
                    stop: function () {
                        var draggedItemId = $(this).attr('id');
                        $(this).css({ 'z-index': '0' });
                        $(".class" + draggedItemId).css({ 'z-index': '10' });
                        if ($(this).position().left < 0) {
                            $(this).css({ 'left': '0' });
                        }
                        if ($(this).position().top < 0) {
                            $(this).css({ 'top': '0' });
                        }
                    }
                });
            });
        }
            $("#mainDiv").droppable({
                drop: function (ev, ui) {

                    if (!ui.draggable.hasClass('foo') && !ui.draggable.hasClass('display')) {
                        var pos = ui.draggable.offset(), dPos = $(this).offset();
                        var droppedTop = ui.position.top - $(this).offset().top + $('#mainDiv').scrollTop();;
                        var droppedLeft = ui.position.left - $(this).offset().left + $('#mainDiv').scrollLeft();;
                        var Class = ui.draggable.attr("class");
                        var title = ui.draggable.text().trim();
                        var item = $('<table class="foo elementTable ' + Class + '" name="' + title + '" id="' + (counter + 1) + '" style="left: ' + droppedLeft + 'px; top: ' + droppedTop + 'px;"><tr class="tableHeader"><th class="thClass"><span class="header' + (counter + 1) + '">' + title + '</span><span class="settings"><img src="/Icons/pignon.png" width="17px" height="17px" alt="Settings" title="Settings" /></span></th></tr><tr"><td class="add"><span class="addList' + (counter + 1)+'"></span></td></tr></table>');
                        $(this).append(item);
                        counter++;
                        foo();
                    }
                }
            });

            $("#mainDiv .foo").draggable();

            var mouseDown = false;
            var prevCoords = { x: 0, y: 0 };

            //$("#mainDiv").mousedown(function (e) {
            //    mouseDown = !$(e.target).closest('.foo').length;
            //}).mousemove(function (e) {
            //    var currentScrollX = $('#mainDiv').scrollLeft();
            //    var currentScrollY = $('#mainDiv').scrollTop();
            //    if (mouseDown) {
            //        $('#mainDiv').scrollLeft(currentScrollX + prevCoords.x - e.clientX)
            //        $('#mainDiv').scrollTop(currentScrollY + prevCoords.y - e.clientY)
            //    };
            //    prevCoords.x = e.clientX;
            //    prevCoords.y = e.clientY;
            //}).mouseup(function () {
            //    mouseDown = false;
            //});

            //$('.foo').on('drag', function () {
            //    alert("sa");
            //    if ($(this).left() == 0) {
            //        return false;
            //    }
            //});
    });

</script>

<style>
    .dropdown-wrap,
    .widget_search.styled,
    .widget_profile {
        border-radius: 5px;
        -webkit-border-radius: 5px;
        -moz-border-radius: 5px;
        -webkit-box-shadow: 0 16px 20px -8px rgba(0, 0, 0, 0.3);
        -moz-box-shadow: 0 16px 20px -8px rgba(0, 0, 0, 0.3);
        box-shadow: 0 16px 20px -8px rgba(0, 0, 0, 0.3);
        margin-bottom: 50px;
    }

    .widget_search .inner {
        padding: 14px;
    }

    .widget_search .input_wrap {
        margin-right: 90px;
        position: relative;
    }

    .widget_search .btn,
    .newsletterBox .btn {
        float: right;
        margin-top: 1px;
    }

    .widget_search .input_wrap input {
        height: 33px;
        padding-left: 30px;
    }

    .widget_search input::-webkit-input-placeholder {
        color: #a4a4a4;
    }

    .widget_search input:-moz-placeholder {
        color: #a4a4a4;
    }

    .widget_search .input_icon {
        background: url(images/icons/search.png);
        width: 16px;
        height: 16px;
        left: 10px;
        top: 9px;
        right: auto;
    }
</style>

