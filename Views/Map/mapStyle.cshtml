@{
    var gps = ViewBag.MapGPS;
}
<html>
<head>
    <title>Styled Maps - Night Mode</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
         #map {
             height: 100%;
         }
         html, body {
             height: 100%;
             margin: 0;
             padding: 0;
         }
    </style>
</head>
<body>
    <div id="map"></div>
    @*<div style="margin-top:-4%; position:absolute">
        <input type="button" id="edit_line" value="Edit" class="btn" style="height:20px; width:50px;line-height:6px; margin-left:10px;">
        <input type="button" id="add_line" value="Add" class="btn" style="height:20px; width:50px;line-height:6px;margin-top:-5%; margin-left:10%; position:absolute">
        <input type="button" id="delete_line" value="delete" class="btn" style="height:20px; width:50px;line-height:6px;margin-top:-5%; margin-left:20%; position:absolute">
    </div>*@
        <script type="text/javascript">
        var listgps = @Html.Raw(Json.Encode(@ViewBag.MapGPS));
        var arra = new Array();
        var linearray = new Array();
        var marker = new Array();
        var startposition, finishposition;
        function initMap() {
            // Styles a map in night mode.
            var map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 42.315407, lng: 43.356892 },
                zoom: 8,
                panControl: true,
                zoomControl: true,
                mapTypeControl: false,
                scaleControl: false,
                streetViewControl: false,
                overviewMapControl: false,
                provinceControl: false,
                styles: [
                    {
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#1d2c4d"
                            }
                        ]
                    },
                    {
                        "elementType": "labels",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#8ec3b9"
                            }
                        ]
                    },
                    {
                        "elementType": "labels.text.stroke",
                        "stylers": [
                            {
                                "color": "#1a3646"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative",
                        "stylers": [
                            {
                                "weight": 2
                            }
                        ]
                    },
                    {
                        "featureType": "administrative",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "weight": 1.5
                            }
                        ]
                    },
                    {
                        "featureType": "administrative",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.country",
                        "stylers": [
                            {
                                "weight": 2.5
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.country",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.country",
                        "elementType": "geometry.stroke",
                        "stylers": [
                            {
                                "color": "#4b6878"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.land_parcel",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#64779e"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.locality",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.locality",
                        "elementType": "geometry.stroke",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.neighborhood",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.province",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative.province",
                        "elementType": "geometry.stroke",
                        "stylers": [
                            {
                                "color": "#4b6878"
                            },
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    { //feris dizaini
                        "featureType": "landscape.man_made",
                        "elementType": "geometry.stroke",
                        "stylers": [
                            {
                                "color": "#334e87"
                            }
                        ]
                    },
                    {
                        "featureType": "landscape.natural",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#023e58"
                            }
                        ]
                    },
                    {
                        "featureType": "poi",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#283d6a"
                            }
                        ]
                    },
                    {
                        "featureType": "poi",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#6f9ba5"
                            }
                        ]
                    },
                    {
                        "featureType": "poi",
                        "elementType": "labels.text.stroke",
                        "stylers": [
                            {
                                "color": "#1d2c4d"
                            }
                        ]
                    },
                    {
                        "featureType": "poi.park",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "color": "#023e58"
                            }
                        ]
                    },
                    {
                        "featureType": "poi.park",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#3C7680"
                            }
                        ]
                    },
                    {
                        "featureType": "road",
                        "stylers": [
                            {
                                "visibility": "off"
                            }
                        ]
                    },
                    {
                        "featureType": "road",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#304a7d"
                            }
                        ]
                    },
                    {
                        "featureType": "road",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#98a5be"
                            }
                        ]
                    },
                    {
                        "featureType": "road",
                        "elementType": "labels.text.stroke",
                        "stylers": [
                            {
                                "color": "#1d2c4d"
                            }
                        ]
                    },
                    {
                        "featureType": "road.highway",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#2c6675"
                            }
                        ]
                    },
                    {
                        "featureType": "road.highway",
                        "elementType": "geometry.stroke",
                        "stylers": [
                            {
                                "color": "#255763"
                            }
                        ]
                    },
                    {
                        "featureType": "road.highway",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#b0d5ce"
                            }
                        ]
                    },
                    {
                        "featureType": "road.highway",
                        "elementType": "labels.text.stroke",
                        "stylers": [
                            {
                                "color": "#023e58"
                            }
                        ]
                    },
                    {
                        "featureType": "transit",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#98a5be"
                            }
                        ]
                    },
                    {
                        "featureType": "transit",
                        "elementType": "labels.text.stroke",
                        "stylers": [
                            {
                                "color": "#1d2c4d"
                            }
                        ]
                    },
                    {
                        "featureType": "transit.line",
                        "elementType": "geometry.fill",
                        "stylers": [
                            {
                                "color": "#283d6a"
                            }
                        ]
                    },
                    {
                        "featureType": "transit.station",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#3a4762"
                            }
                        ]
                    },
                    {
                        "featureType": "water",
                        "elementType": "geometry",
                        "stylers": [
                            {
                                "color": "#0e1626"
                            }
                        ]
                    },
                    {
                        "featureType": "water",
                        "elementType": "labels.text.fill",
                        "stylers": [
                            {
                                "color": "#4e6d70"
                            }
                        ]
                    }
                ]
            });
            var myCenter = new google.maps.LatLng(42.280200, 42.736320);
            var image = {
                url: "../image/mapImage/antenna.gif", // url
                size: new google.maps.Size(50, 50),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(17, 34),
                scaledSize: new google.maps.Size(40, 40),

            };
            var img = {
                url: "../image/mapImage/tow.gif", // url
                size: new google.maps.Size(50, 50),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(17, 34),
                scaledSize: new google.maps.Size(40, 40),

            };

            $.each(listgps, function (i, val) {
              var  marker =new google.maps.Marker({
                    position: new google.maps.LatLng(val.lattitube, val.longitube),
                    map: map,
                    icon: image,
                    title: val.cityname

                });
              //map.setCenter(marker.getPosition());
              var infowindow = new google.maps.InfoWindow();
              google.maps.event.addListener(marker, 'rightclick', (function (marker, infowindow) {
                  return function () {
                      if (marker.getAnimation() != null) {
                          marker.setAnimation(null);
                      } else {
                          //marker.setUrl("../image/mapImage/tow.gif")
                          marker.setIcon({ url: img }); 
                          marker.setAnimation(google.maps.Animation.BOUNCE);
                          startposition= marker.position;
                      }
                  };
              })(marker, infowindow));
              google.maps.event.addListener(marker, 'click', (function (marker, infowindow) {
                  return function () {
                      var lineSymbol = {
                          path: 'M 0,-1 0,1',
                          strokeOpacity: 0.7,
                          scale: 2
                      };
                      var flightPath = new google.maps.Polyline({
                          path: [startposition, marker.position],
                    geodesic: true,
                    strokeColor: '#009900',
                    strokeOpacity: 0.7,
                    strokeWeight: 2,
                    map: map,
                    icons: [{
                        icon: { path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW },
                        offset: '100%',
                        repeat: '80px'
                    }]
                });
                  };
              })(marker, infowindow));

            });

            //google.maps.event.addListener(marker, 'click', function () {
            //    if (lastWindow) lastWindow.close();
            //    this.infowindow.open(map, this);
            //    lastWindow = infowindow;
            //});

            //var startline = new google.maps.LatLng(41.695740, 44.785260);
            //var allCoordinates = [
            //    new google.maps.LatLng(41.670090, 44.688240),
            //    new google.maps.LatLng(42.280110, 42.736320),
            //    new google.maps.LatLng(41.693580, 41.714820),
            //    new google.maps.LatLng(42.413310, 41.818140)
            //];
            //var lineSymbol = {
            //    path: 'M 0,-1 0,1',
            //    strokeOpacity: 0.7,
            //    scale: 2
            //};
            //for (var i = 1; i <= allCoordinates.length; i++) {
            //    var flightPath = new google.maps.Polyline({
            //        path: [allCoordinates[0], allCoordinates[i]],
            //        geodesic: true,
            //        strokeColor: '#009900',
            //        strokeOpacity: 1,
            //        strokeWeight: 2,
            //        map: map,
            //        icons: [{
            //            icon: { path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW },
            //            offset: '100%',
            //            repeat: '80px'
            //        }]
            //    });
            //    var flightPath = new google.maps.Polyline({
            //        path: [allCoordinates[0], allCoordinates[i]],
            //        geodesic: true,
            //        strokeColor: '#000000',
            //        strokeOpacity: 0.2,
            //        strokeWeight: 2,
            //        map: map,
            //        animation: google.maps.Animation.DROP,
            //        icons: [{
            //            icon: lineSymbol,
            //            offset: '100%',
            //            repeat: '20px'
            //        }],
            //    });
            //}

           //google.maps.event.addDomListener(map, 'click', function () {
           //    window.alert(marker[1].position);
           //});
        }
           // flightPath.setMap(map);
            //var polyline = new google.maps.Polyline({
            //    path: allCoordinates,
            //    strokeColor: color,
            //    strokeOpacity: 1.0,
            //    strokeWeight: 2,
            //    geodesic: true,
            //    icons: [{
            //        icon: { path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW },
            //        offset: '100%',
            //        repeat: '20px'
            //    }]
            //});
            //polyline.setMap(map);

          //  google.maps.event.addDomListener(window, 'load', initMap);



    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOjC5S0IeB6iri-m5G82-PNMu4EfyrqIs&callback=initMap"></script>
</body>
</html>